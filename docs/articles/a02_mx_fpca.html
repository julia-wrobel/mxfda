<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>mx_fpca • mxfda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="mx_fpca">
<meta property="og:description" content="mxfda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mxfda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_mx_fda.html">mx_fda</a>
    </li>
    <li>
      <a href="../articles/a02_mx_fpca.html">mx_fpca</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>mx_fpca</h1>
            
      
      
      <div class="hidden name"><code>a02_mx_fpca.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the <code>mxfda</code> package for analyzing
single-cell multiplex imaging data using tools from functional data
analysis. Analyses for this package are executed and stored using an S4
object of class <code>mxFDA</code>. This vignette outlines how to set up
an <code>mxFDA</code> object from spatial single cell imaging data, how
to calculate spatial summary functions, and exploratory data analysis
and visualization of these spatial summary functions. Details on how to
perform downstream analysis and feature extraction using functional
principal components analysis can be found in the separate vignette
<code>mx_fpca</code>. To perform functional regression on spatial
summary functions from multiplex imaging data, see the
<code>mx_funreg</code> vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(mxfda)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.4</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.4.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">mxfda</span></span></span>
<span><span class="co">#&gt; Loading required package: spatstat.explore</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loading required package: spatstat.data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loading required package: spatstat.geom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; spatstat.geom 3.2-7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'spatstat.geom'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:patchwork':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     area</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loading required package: spatstat.random</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; spatstat.random 3.2-1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nlme'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; spatstat.explore 3.2-5</span></span></code></pre></div>
<div class="section level2">
<h2 id="functional-data-notation">Functional data notation<a class="anchor" aria-label="anchor" href="#functional-data-notation"></a>
</h2>
<p>The basic unit of observation is the curve <span class="math inline">\(Y_i(t)\)</span> for subjects <span class="math inline">\(i \in \ldots, I\)</span> in the cross-sectional
setting and <span class="math inline">\(Y_{ij}(t)\)</span> for subject
<span class="math inline">\(i\)</span> at visit <span class="math inline">\(j \in \ldots, J_i\)</span> for the multilevel or
longitudinal structure. Methods for functional data are typically
presented in terms of continuous functions, but in practice data are
observed on a discrete grid that may be sparse or dense at the subject
level and that may be the same across subjects or irregular.</p>
</div>
<div class="section level2">
<h2 id="functional-principal-components-analysis-fpca">Functional principal components analysis (FPCA)<a class="anchor" aria-label="anchor" href="#functional-principal-components-analysis-fpca"></a>
</h2>
<div class="section level3">
<h3 id="background-on-fpca">Background on FPCA<a class="anchor" aria-label="anchor" href="#background-on-fpca"></a>
</h3>
<p>Background on FPCA</p>
<p>FPCA characterizes modes of variability by decomposing functional
observations into population level basis functions and subject-specific
scores . The basis functions have a clear interpretation, analogous to
that of PCA: the first basis function explains the largest direction of
variation, and each subsequent basis function describes less. The FPCA
model is typically written Y_i(t) = (t) + <em>{k=1}^{K}
c</em>{ik}_{k}(t) + _i(t) where <span class="math inline">\(\mu(t)\)</span> is the population mean, <span class="math inline">\(\psi_{k}(t)\)</span> are a set of orthonormal
population-level basis functions, <span class="math inline">\(c_{ik}\)</span> are subject-specific scores with
mean zero and variance <span class="math inline">\(\lambda_k\)</span>,
and <span class="math inline">\(\epsilon_i(t)\)</span> are residual
curves. Estimated basis functions <span class="math inline">\(\widehat{\psi}_1(t), \widehat{\psi}_2(t), \ldots,
\widehat{\psi}_{K}(t)\)</span> and corresponding variances <span class="math inline">\(\widehat{\lambda}_1 \geq \widehat{\lambda}_2 \geq
\ldots \geq \widehat{\lambda}_K\)</span> are obtained from a truncated
Karhunen-Lo`eve decomposition of the sample covariance <span class="math inline">\(\widehat{\Sigma}(s,t) =
\widehat{\mbox{Cov}}(Y_i(s), Y_i(t))\)</span>. In practice, the
covariance <span class="math inline">\(\widehat{\Sigma}(s,t)\)</span> is
often smoothed using a bivariate smoother that omits entries on the main
diagonal to avoid a ``nugget effect” attributable to measurement error,
and scores are estimated in a mixed model framework . The truncation lag
<span class="math inline">\(K\)</span> is often chosen so that the
resulting approximation accounts for at least 95% of observed
variance.</p>
</div>
<div class="section level3">
<h3 id="implementing-fpca">Implementing FPCA<a class="anchor" aria-label="anchor" href="#implementing-fpca"></a>
</h3>
<div class="section level4">
<h4 id="load-and-visualize-data">Load and visualize data<a class="anchor" aria-label="anchor" href="#load-and-visualize-data"></a>
</h4>
<p>Here we load data from the Ovarian cancer dataset that where
univariate nearest-neighbor G-functions for immune cells have already
been extracted. See the vignette <code>mxfda::mx_fda</code> for more
details on extracting spatial summary functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ovarian_FDA"</span><span class="op">)</span></span></code></pre></div>
<p>These functions are visualized below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, y <span class="op">=</span> <span class="st">"fundiff"</span>, what <span class="op">=</span> <span class="st">"uni g"</span>, sampleID <span class="op">=</span> <span class="st">"patient_id"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="a02_mx_fpca_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="run-and-visualize-fpca">Run and visualize FPCA<a class="anchor" aria-label="anchor" href="#run-and-visualize-fpca"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_fpca.html">run_fpca</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, </span>
<span>                        metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, </span>
<span>                        value <span class="op">=</span> <span class="st">"fundiff"</span>,</span>
<span>                        pve <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<p>Explain each of these plots</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, what <span class="op">=</span> <span class="st">'uni g fpca'</span>, pc_choice <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, what <span class="op">=</span> <span class="st">'uni g fpca'</span>, pc_choice <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, what <span class="op">=</span> <span class="st">'uni g fpca'</span>, pc_choice <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, what <span class="op">=</span> <span class="st">'uni g fpca'</span>, pc_choice <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<p><img src="a02_mx_fpca_files/figure-html/fpc_plots-1.png" width="960"></p>
<p>INTERPRET WHAT YOU LEARNED FROM FPCA- this is an important piece</p>
<p>Shout out to refund.shiny</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G_fpca</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_fpca_object.html">extract_fpca_object</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>,</span>
<span>                             what <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">G_fpca</span><span class="op">)</span></span>
<span><span class="co">#library(refund.shiny)</span></span>
<span><span class="co">#plot_shiny(G_fpca)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="mfpca">MFPCA<a class="anchor" aria-label="anchor" href="#mfpca"></a>
</h2>
<div class="section level3">
<h3 id="mfpca-background">MFPCA Background<a class="anchor" aria-label="anchor" href="#mfpca-background"></a>
</h3>
<p>Background on mfpca</p>
<p>Multilevel functional principal components analysis (MFPCA) extends
the ideas of FPCA to functional data with a multilevel structure.</p>
<p>Multilevel functional data are increasingly common in practice; in
the case of our DTI example, this structure arises from multiple
clinical visits made by each subject. MFPCA models the within-subject
correlation induced by repeated measures as well as the between-subject
correlation modeled by classic FPCA. This leads to a two-level FPC
decomposition, where level 1 concerns subject-specific effects and level
2 concerns visit-specific effects. Population-level basis functions and
subject-specific scores are calculated for both levels . The MFPCA model
is:</p>
<p><span class="math display">\[
    X_{ij}(r) = \mu(r)  +
\sum_{k_1=1}^{K_1}    c_{ik}^{(1)}\psi_{k}^{(1)}(r) +
\sum_{k_2=1}^{K_2}c^{(2)}_{ijk}\psi_{k}^{(2)}(r) + \epsilon_{ij}(r)
\]</span></p>
<p> where <span class="math inline">\(\mu(t)\)</span> is the population
mean, <span class="math inline">\(\eta_j(t)\)</span> is the
visit-specific shift from the overall mean, <span class="math inline">\(\psi_{k}^{(1)}(t)\)</span> and <span class="math inline">\(\psi_{k}^{(2)}(t)\)</span> are the eigenfunctions
for levels 1 and 2, respectively, and <span class="math inline">\(c_{ik}^{(1)}\)</span> and <span class="math inline">\(c^{(2)}_{ijk}\)</span> are the subject-specific
and subject-visit-specific scores. Often, visit-specific means <span class="math inline">\(\eta_j(t)\)</span> are not of interest and can be
omitted from the model. Estimation for MFPCA extends the approach for
FPCA: estimated between- and within-covariances <span class="math inline">\(\widehat{\Sigma}^{(1)}(s,t) =
\widehat{\mbox{Cov}}(Y_{ij}(s), Y_{ij'}(t))\)</span> for <span class="math inline">\(j \neq j'\)</span> and <span class="math inline">\(\widehat{\Sigma}^{(2)}(s,t) =
\widehat{\mbox{Cov}}(Y_{ij}(s), Y_{ij}(t))\)</span> are derived from the
observed data, smoothed, and decomposed to obtain eigenfunctions and
values. Given these objects, scores are estimated in a mixed-model
framework.</p>
</div>
<div class="section level3">
<h3 id="implementing-mfpca">Implementing MFPCA<a class="anchor" aria-label="anchor" href="#implementing-mfpca"></a>
</h3>
<p>Explain that there are multiple curves per subject for MFPCA and
that’s why lung data is better for mfpca</p>
<div class="section level4">
<h4 id="extract-spatial-summary-functions-and-visualize-data">Extract spatial summary functions and visualize data<a class="anchor" aria-label="anchor" href="#extract-spatial-summary-functions-and-visualize-data"></a>
</h4>
<p>Here we extract the univariate K function from the lung data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lung_df</span><span class="op">)</span></span>
<span><span class="va">clinical</span> <span class="op">=</span> <span class="va">lung_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">image_id</span>, <span class="va">patient_id</span>, <span class="va">patientImage_id</span>, <span class="va">gender</span>, <span class="va">age</span>, <span class="va">survival_days</span>, <span class="va">survival_status</span>, <span class="va">stage</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spatial</span> <span class="op">=</span> <span class="va">lung_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">image_id</span>, <span class="op">-</span><span class="va">gender</span>, <span class="op">-</span><span class="va">age</span>, <span class="op">-</span><span class="va">survival_days</span>, <span class="op">-</span><span class="va">survival_status</span>, <span class="op">-</span><span class="va">stage</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mxFDAobject</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_mxfda.html">make_mxfda</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="va">clinical</span>,</span>
<span>                         spatial <span class="op">=</span> <span class="va">spatial</span>,</span>
<span>                         subject_key <span class="op">=</span> <span class="st">"patient_id"</span>,</span>
<span>                         sample_key <span class="op">=</span> <span class="st">"patientImage_id"</span></span>
<span>                         <span class="op">)</span></span>
<span></span>
<span><span class="va">mxFDAobject</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_summary_functions.html">extract_summary_functions</a></span><span class="op">(</span><span class="va">mxFDAobject</span>, </span>
<span>                                        extract_func <span class="op">=</span> <span class="va">extract_univariate</span>,</span>
<span>                                        summary_func <span class="op">=</span> <span class="va">Kest</span>,</span>
<span>                                        r_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                        edge_correction <span class="op">=</span> <span class="st">"iso"</span>,</span>
<span>                                        markvar <span class="op">=</span> <span class="st">"immune"</span>,</span>
<span>                                        mark1 <span class="op">=</span> <span class="st">"immune"</span><span class="op">)</span></span></code></pre></div>
<p>Visualize</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mxFDAobject</span>, y <span class="op">=</span> <span class="st">"fundiff"</span>, what <span class="op">=</span> <span class="st">"uni k"</span>, sampleID <span class="op">=</span> <span class="st">"patientImage_id"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 48 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="a02_mx_fpca_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Do some summaries (how many total functions? How many subjects? Range
of number of functions per subject?)</p>
</div>
<div class="section level4">
<h4 id="run-and-visualize-mfpca">Run and visualize MFPCA<a class="anchor" aria-label="anchor" href="#run-and-visualize-mfpca"></a>
</h4>
<p>Right now this takes the same id in both slots and splits it under
the hood. need to change this behavior</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># see what happens when you use mfpca.sc as an engine</span></span>
<span><span class="va">mfpca_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mfpca.html">run_mfpca</a></span><span class="op">(</span><span class="va">mxFDAobject</span>, </span>
<span>                       id <span class="op">=</span> <span class="st">"id"</span>, </span>
<span>                                  image_id <span class="op">=</span> <span class="st">"image_id"</span>, </span>
<span>                                  metric <span class="op">=</span> <span class="st">"uni k"</span>, r <span class="op">=</span> <span class="st">"r"</span>, </span>
<span>                                  value <span class="op">=</span> <span class="st">"fundiff"</span>,</span>
<span>                                  pve <span class="op">=</span> <span class="fl">.99</span>,</span>
<span>                       lightweight <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Explore FPCA object</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mfpca_obj</span><span class="op">$</span><span class="va">score_df</span></span>
<span><span class="co">#&gt;       level1_1  id</span></span>
<span><span class="co">#&gt; 1   3936.86029  10</span></span>
<span><span class="co">#&gt; 2   8882.73877 103</span></span>
<span><span class="co">#&gt; 3   1473.30942 105</span></span>
<span><span class="co">#&gt; 4   3811.05743 107</span></span>
<span><span class="co">#&gt; 5     53.91890 109</span></span>
<span><span class="co">#&gt; 6  -1218.53796 113</span></span>
<span><span class="co">#&gt; 7     -3.50964 117</span></span>
<span><span class="co">#&gt; 8   -851.89981 118</span></span>
<span><span class="co">#&gt; 9  -2164.21564 123</span></span>
<span><span class="co">#&gt; 10 -4046.45934 124</span></span>
<span><span class="co">#&gt; 11 13803.36957 128</span></span>
<span><span class="co">#&gt; 12 -1167.37156 130</span></span>
<span><span class="co">#&gt; 13 -2951.27375 131</span></span>
<span><span class="co">#&gt; 14 -1072.74459 133</span></span>
<span><span class="co">#&gt; 15 -3728.83018 134</span></span>
<span><span class="co">#&gt; 16 -4142.07427 138</span></span>
<span><span class="co">#&gt; 17  -262.35872 142</span></span>
<span><span class="co">#&gt; 18 -3604.49573 145</span></span>
<span><span class="co">#&gt; 19 -1815.06872 147</span></span>
<span><span class="co">#&gt; 20   214.74678  16</span></span>
<span><span class="co">#&gt; 21 -3919.36589  19</span></span>
<span><span class="co">#&gt; 22 -5592.08236   2</span></span>
<span><span class="co">#&gt; 23  5265.64394  26</span></span>
<span><span class="co">#&gt; 24 21754.54825  30</span></span>
<span><span class="co">#&gt; 25 -1963.05428  31</span></span>
<span><span class="co">#&gt; 26 -3104.76419  32</span></span>
<span><span class="co">#&gt; 27 -3280.46413  35</span></span>
<span><span class="co">#&gt; 28  4784.97286  39</span></span>
<span><span class="co">#&gt; 29  1992.83225  40</span></span>
<span><span class="co">#&gt; 30 -1426.58293  41</span></span>
<span><span class="co">#&gt; 31 -2795.27385  44</span></span>
<span><span class="co">#&gt; 32   -13.31964  53</span></span>
<span><span class="co">#&gt; 33 -3767.69401  55</span></span>
<span><span class="co">#&gt; 34 -3631.84593  56</span></span>
<span><span class="co">#&gt; 35  1906.58391  57</span></span>
<span><span class="co">#&gt; 36  -685.56886  60</span></span>
<span><span class="co">#&gt; 37 -2543.19291  63</span></span>
<span><span class="co">#&gt; 38 -4400.27658  66</span></span>
<span><span class="co">#&gt; 39 -3623.03787  67</span></span>
<span><span class="co">#&gt; 40 -2121.81682  68</span></span>
<span><span class="co">#&gt; 41  3382.96857  70</span></span>
<span><span class="co">#&gt; 42 -4118.03288  75</span></span>
<span><span class="co">#&gt; 43 -1199.67750  76</span></span>
<span><span class="co">#&gt; 44 -4969.64216  77</span></span>
<span><span class="co">#&gt; 45 -1645.28185  78</span></span>
<span><span class="co">#&gt; 46  8472.31739   8</span></span>
<span><span class="co">#&gt; 47   853.99575  87</span></span>
<span><span class="co">#&gt; 48 -3284.96108   9</span></span>
<span><span class="co">#&gt; 49  -582.92011  90</span></span>
<span><span class="co">#&gt; 50 -1684.61540  93</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mfpca_obj</span><span class="op">$</span><span class="va">scores_level2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 246   5</span></span>
<span></span>
<span><span class="va">mfpca_obj</span><span class="op">$</span><span class="va">scores_level2</span></span>
<span><span class="co">#&gt;         level2_1      level2_2      level2_3  id image_id</span></span>
<span><span class="co">#&gt; 1     5082.65643    751.849903   579.4874217  10        1</span></span>
<span><span class="co">#&gt; 2     6999.44578   1479.386325   -25.3599163  10        2</span></span>
<span><span class="co">#&gt; 3      682.01965     60.095435  1308.2657948  10        3</span></span>
<span><span class="co">#&gt; 4    -6001.85666  -1697.601627  -154.2892707  10        4</span></span>
<span><span class="co">#&gt; 5     5452.47602    997.506558  -254.2975564  10        5</span></span>
<span><span class="co">#&gt; 6     7423.88945  -7280.641273 -2181.9660162 103        1</span></span>
<span><span class="co">#&gt; 7    -2633.37760  -1259.125855  2210.0739406 103        2</span></span>
<span><span class="co">#&gt; 8      322.88826   2924.495278   582.6303244 103        3</span></span>
<span><span class="co">#&gt; 9   -96349.86740  13013.189713 -1929.0434119 103        4</span></span>
<span><span class="co">#&gt; 10    2594.04790   3070.475898   601.6400496 103        5</span></span>
<span><span class="co">#&gt; 11    -107.62157   -253.127817  -556.9491098 105        1</span></span>
<span><span class="co">#&gt; 12    3349.19446   1193.175939   104.9837867 105        2</span></span>
<span><span class="co">#&gt; 13   -4978.71930   1350.126284   -59.7522559 105        3</span></span>
<span><span class="co">#&gt; 14   -2522.02732  -1567.088059 -1028.7442144 105        4</span></span>
<span><span class="co">#&gt; 15   12035.66337   -999.592792 -1412.6640560 107        1</span></span>
<span><span class="co">#&gt; 16   10759.46731    865.474728   -34.8636426 107        2</span></span>
<span><span class="co">#&gt; 17    -586.29071   1056.839869   223.1963206 107        3</span></span>
<span><span class="co">#&gt; 18    6960.53228   1311.163134   536.8957588 107        4</span></span>
<span><span class="co">#&gt; 19    4279.20036   1891.742121   289.2847811 107        5</span></span>
<span><span class="co">#&gt; 20    3580.59883   -865.421352   711.2049076 109        1</span></span>
<span><span class="co">#&gt; 21    7117.60621    325.508926   266.5993075 109        2</span></span>
<span><span class="co">#&gt; 22    2675.60268   -687.803124   639.5939778 109        3</span></span>
<span><span class="co">#&gt; 23    2604.65698    683.928117   -51.6655515 109        4</span></span>
<span><span class="co">#&gt; 24    3764.22698    124.735892  -264.2164037 109        5</span></span>
<span><span class="co">#&gt; 25   -1887.31031   -647.028208   165.3984641 113        1</span></span>
<span><span class="co">#&gt; 26    1426.96753   -870.010490 -1211.0218523 113        2</span></span>
<span><span class="co">#&gt; 27    -792.39539  -3906.460900   184.2552244 113        3</span></span>
<span><span class="co">#&gt; 28   -1872.67290  -4610.276400   802.9792563 113        4</span></span>
<span><span class="co">#&gt; 29     342.64764   1130.820335   113.9692762 113        5</span></span>
<span><span class="co">#&gt; 30   -2243.19464   -696.706628    -5.4323964 117        1</span></span>
<span><span class="co">#&gt; 31    8207.40460   -866.145250   310.6122288 117        2</span></span>
<span><span class="co">#&gt; 32    4743.57585   -206.835771   100.6337279 117        3</span></span>
<span><span class="co">#&gt; 33   -4341.80378   -241.783834  -850.0459785 117        4</span></span>
<span><span class="co">#&gt; 34     262.70801    885.021402   350.7009610 117        5</span></span>
<span><span class="co">#&gt; 35    1421.11309   -688.890402   109.7626358 118        1</span></span>
<span><span class="co">#&gt; 36   -1714.42145    -58.635315  -168.8285735 118        2</span></span>
<span><span class="co">#&gt; 37    5392.65016   -736.587062   147.9566644 118        3</span></span>
<span><span class="co">#&gt; 38     652.54015   -145.294333  -196.2256362 118        4</span></span>
<span><span class="co">#&gt; 39    -294.00792    882.394343  -229.7799600 118        5</span></span>
<span><span class="co">#&gt; 40   -1248.38252     26.718152   183.2524074 123        1</span></span>
<span><span class="co">#&gt; 41   -5163.97977   1371.314671  -663.4286388 123        2</span></span>
<span><span class="co">#&gt; 42   -3826.86854   -785.336678  -235.4948966 123        3</span></span>
<span><span class="co">#&gt; 43   -9560.70975    174.187072   120.8330007 123        4</span></span>
<span><span class="co">#&gt; 44    2100.89248    185.709104   -23.9067380 123        5</span></span>
<span><span class="co">#&gt; 45     238.55381    338.944532  -245.0385799 124        1</span></span>
<span><span class="co">#&gt; 46   -2371.77850  -1075.630905   238.9486586 124        2</span></span>
<span><span class="co">#&gt; 47   -2291.64230    176.925337  -112.0268139 124        3</span></span>
<span><span class="co">#&gt; 48    1606.64802    -28.620401  -284.4980995 124        4</span></span>
<span><span class="co">#&gt; 49    2144.16100     45.780746  -150.6565091 124        5</span></span>
<span><span class="co">#&gt; 50    4786.42344   5430.337402   -79.5143627 128        1</span></span>
<span><span class="co">#&gt; 51  -12634.01893   1325.806018  3156.4390375 128        2</span></span>
<span><span class="co">#&gt; 52   -4768.28948  -2852.367650 -8257.9025876 128        3</span></span>
<span><span class="co">#&gt; 53  -40699.05909 -26994.318107 -1590.9888109 128        4</span></span>
<span><span class="co">#&gt; 54    9072.21738   4041.316898  1483.7858022 128        5</span></span>
<span><span class="co">#&gt; 55     959.41034    126.279405   -86.9774988 130        1</span></span>
<span><span class="co">#&gt; 56    2539.91538    -46.377621  -645.8679679 130        2</span></span>
<span><span class="co">#&gt; 57   -2108.84741    511.894355   -25.6746892 130        3</span></span>
<span><span class="co">#&gt; 58    4220.22769      6.734064   113.8018556 130        4</span></span>
<span><span class="co">#&gt; 59    2680.64421  -1145.659580  -486.5819232 130        5</span></span>
<span><span class="co">#&gt; 60     613.61445   -245.834739  -506.9014564 131        1</span></span>
<span><span class="co">#&gt; 61   -3089.56295  -1383.447905    56.9690246 131        2</span></span>
<span><span class="co">#&gt; 62   -9083.13078   1237.610554  -155.3932272 131        3</span></span>
<span><span class="co">#&gt; 63    2995.92801    141.441257  -192.5839714 131        4</span></span>
<span><span class="co">#&gt; 64    2097.40647    404.804105  -109.4257967 131        5</span></span>
<span><span class="co">#&gt; 65    2449.47071   -396.699206   -21.2103059 133        1</span></span>
<span><span class="co">#&gt; 66   -2640.72010    650.922359  -326.2646214 133        2</span></span>
<span><span class="co">#&gt; 67   -4154.18515     46.768484   250.0191906 133        3</span></span>
<span><span class="co">#&gt; 68    2412.01287   -544.100711  -764.0351200 133        4</span></span>
<span><span class="co">#&gt; 69   -2657.44107  -1573.295927   962.1550044 133        5</span></span>
<span><span class="co">#&gt; 70   -1716.41319    502.745642  -305.9341811 134        1</span></span>
<span><span class="co">#&gt; 71   -4506.63502    803.416385  -381.3625144 134        2</span></span>
<span><span class="co">#&gt; 72    -156.96125    428.519639  -318.7875077 134        3</span></span>
<span><span class="co">#&gt; 73     782.80955   -815.825257   -64.4954501 134        4</span></span>
<span><span class="co">#&gt; 74   -1468.86349    -77.098061  -331.3273233 134        5</span></span>
<span><span class="co">#&gt; 75     -86.67816   -185.304283  -135.6221097 138        1</span></span>
<span><span class="co">#&gt; 76   -1795.31533    432.950470  -295.1625834 138        2</span></span>
<span><span class="co">#&gt; 77     842.48851   -230.596690  -316.0196699 138        3</span></span>
<span><span class="co">#&gt; 78     680.95791      2.583262  -198.6618259 138        4</span></span>
<span><span class="co">#&gt; 79    -859.70701  -1739.354509  1916.6572994 142        1</span></span>
<span><span class="co">#&gt; 80    5383.02925    194.344917   299.3683409 142        2</span></span>
<span><span class="co">#&gt; 81    1207.63771   1094.481253     0.5016803 142        3</span></span>
<span><span class="co">#&gt; 82    3874.05052     68.668057   231.9537917 142        4</span></span>
<span><span class="co">#&gt; 83     197.53796   -371.652597   326.1264415 142        5</span></span>
<span><span class="co">#&gt; 84    -330.67744    -16.134644  -251.7380124 145        1</span></span>
<span><span class="co">#&gt; 85    2549.60373   -405.713858  -433.7226407 145        2</span></span>
<span><span class="co">#&gt; 86    2186.50496    -80.268463  -325.4980406 145        3</span></span>
<span><span class="co">#&gt; 87   -1857.84658    129.200255  -285.6165948 145        4</span></span>
<span><span class="co">#&gt; 88     607.99414    160.490105     3.3688816 145        5</span></span>
<span><span class="co">#&gt; 89    1549.37150    766.077754   -19.6984805 147        1</span></span>
<span><span class="co">#&gt; 90   -1514.86449  -1872.808902   224.1233947 147        2</span></span>
<span><span class="co">#&gt; 91   -1446.83272   -906.215646    94.3698290 147        3</span></span>
<span><span class="co">#&gt; 92    1628.48018   -130.013927   224.8234601 147        4</span></span>
<span><span class="co">#&gt; 93    1937.48786   -448.273946  -873.3523321 147        5</span></span>
<span><span class="co">#&gt; 94     717.88038    682.445019   -57.8575273  16        1</span></span>
<span><span class="co">#&gt; 95    1250.22725    617.187992  -201.5547691  16        2</span></span>
<span><span class="co">#&gt; 96    1837.44450   -154.997623   278.8545721  16        3</span></span>
<span><span class="co">#&gt; 97   -7561.44039   1004.812023   191.4363270  16        4</span></span>
<span><span class="co">#&gt; 98   -2551.00753   1092.701904   221.3102292  16        5</span></span>
<span><span class="co">#&gt; 99   -1819.84328   -623.378220  -345.8318713  19        1</span></span>
<span><span class="co">#&gt; 100 -14783.43497   1100.192218   -58.5383631  19        2</span></span>
<span><span class="co">#&gt; 101    889.78048    -61.589970  -197.3070618  19        3</span></span>
<span><span class="co">#&gt; 102    516.83865    315.612774     2.0615244  19        4</span></span>
<span><span class="co">#&gt; 103    -39.45232    -81.961379  -319.2042438  19        5</span></span>
<span><span class="co">#&gt; 104    523.70543   1937.652897  -959.5723476   2        1</span></span>
<span><span class="co">#&gt; 105  -8059.93067   -417.031608  -122.7100358   2        2</span></span>
<span><span class="co">#&gt; 106  -3657.00385  -1786.668552   -39.2572955   2        3</span></span>
<span><span class="co">#&gt; 107  -1383.08098   -626.393117  -519.8204631   2        4</span></span>
<span><span class="co">#&gt; 108 -11500.47569    428.624037  -451.4762521   2        5</span></span>
<span><span class="co">#&gt; 109  16264.32023    787.246028 -1908.8112684  26        1</span></span>
<span><span class="co">#&gt; 110  -8452.89878    155.616961   689.6654888  26        2</span></span>
<span><span class="co">#&gt; 111  -4290.46581   2924.883967   188.4696731  26        3</span></span>
<span><span class="co">#&gt; 112   4972.54998  -3920.421022   710.1217926  26        4</span></span>
<span><span class="co">#&gt; 113  14283.54300   -858.135555  1727.4928975  30        1</span></span>
<span><span class="co">#&gt; 114  23530.84991   3455.971147  1328.6201253  30        2</span></span>
<span><span class="co">#&gt; 115  24171.66578   1742.953712  2360.2927353  30        3</span></span>
<span><span class="co">#&gt; 116  -7794.55159   1125.740064  3612.3235802  30        4</span></span>
<span><span class="co">#&gt; 117  22129.17126   1827.297092  2515.6580778  30        5</span></span>
<span><span class="co">#&gt; 118   -301.61992   -411.220146  -506.6532342  31        1</span></span>
<span><span class="co">#&gt; 119  -5219.61034    558.519003   -21.1228564  31        2</span></span>
<span><span class="co">#&gt; 120   1741.96007    717.951146  -367.3230949  31        3</span></span>
<span><span class="co">#&gt; 121 -20542.58558    991.213471  -384.9310824  31        4</span></span>
<span><span class="co">#&gt; 122  -4498.12033   -166.740138  -504.6470687  31        5</span></span>
<span><span class="co">#&gt; 123  -8310.90947   1159.699504   -15.3345122  32        1</span></span>
<span><span class="co">#&gt; 124  -3877.56783    166.345148  -941.2298902  32        2</span></span>
<span><span class="co">#&gt; 125 -10716.97983  -2168.541544   925.3849197  32        3</span></span>
<span><span class="co">#&gt; 126 -10638.21265  -1419.043418  -345.0519536  32        4</span></span>
<span><span class="co">#&gt; 127  -2288.38012   -208.397606  -629.1919788  32        5</span></span>
<span><span class="co">#&gt; 128  -8741.16307   1828.055178  -642.9456610  35        1</span></span>
<span><span class="co">#&gt; 129   3596.59173   -936.640062  -682.3493029  35        2</span></span>
<span><span class="co">#&gt; 130  -4495.46430    432.767453  -266.5560559  35        3</span></span>
<span><span class="co">#&gt; 131  -1137.13376    485.465716   -76.6472526  35        4</span></span>
<span><span class="co">#&gt; 132   1612.93087     93.727000  -100.6996786  35        5</span></span>
<span><span class="co">#&gt; 133  10253.56927   -411.152442   218.8559885  39        1</span></span>
<span><span class="co">#&gt; 134   7109.21962    262.144245  -746.3375720  39        2</span></span>
<span><span class="co">#&gt; 135  -1605.46386    611.260597   155.6684562  39        3</span></span>
<span><span class="co">#&gt; 136  25412.93073   -832.951694  1384.2470658  39        4</span></span>
<span><span class="co">#&gt; 137   -320.58404  -3430.470641 -1190.4395373  39        5</span></span>
<span><span class="co">#&gt; 138   4877.96151     52.507204  -477.8400059  40        1</span></span>
<span><span class="co">#&gt; 139   5636.82030  -1139.643251   592.4342661  40        2</span></span>
<span><span class="co">#&gt; 140    327.03967  -1511.630342   -27.8672215  40        3</span></span>
<span><span class="co">#&gt; 141   5959.83097    125.715141  -110.4852359  40        4</span></span>
<span><span class="co">#&gt; 142  -4732.33494  -4326.510890   703.8093175  40        5</span></span>
<span><span class="co">#&gt; 143  -2802.05346    330.583692  -370.3001441  41        1</span></span>
<span><span class="co">#&gt; 144    919.06901   -752.297709    -8.3677570  41        2</span></span>
<span><span class="co">#&gt; 145   1777.13369   -124.951307  -173.1797673  41        3</span></span>
<span><span class="co">#&gt; 146   1205.61275     64.444517  -312.7729913  41        4</span></span>
<span><span class="co">#&gt; 147   3280.75074   -393.639801    79.1761462  41        5</span></span>
<span><span class="co">#&gt; 148  -3551.04640   -465.617619   574.2188397  44        1</span></span>
<span><span class="co">#&gt; 149   1267.67337    103.199537  -179.1708736  44        2</span></span>
<span><span class="co">#&gt; 150   2253.87587    127.121845  -134.1066662  44        3</span></span>
<span><span class="co">#&gt; 151     94.12622    644.404999  -338.0027717  44        4</span></span>
<span><span class="co">#&gt; 152   2138.37569    344.944675  -299.5170133  44        5</span></span>
<span><span class="co">#&gt; 153   1342.73286    244.462869  -453.6457181  53        1</span></span>
<span><span class="co">#&gt; 154   3060.25478     22.134757   161.2129249  53        2</span></span>
<span><span class="co">#&gt; 155    822.62715  -1223.066592   709.7805824  53        3</span></span>
<span><span class="co">#&gt; 156   -578.04175     33.833269  -321.7172660  53        4</span></span>
<span><span class="co">#&gt; 157   6388.66677   -669.065659  -142.5318878  53        5</span></span>
<span><span class="co">#&gt; 158   2484.92030     79.976399   -75.4888022  55        1</span></span>
<span><span class="co">#&gt; 159   1944.56727     97.582832   -95.9300769  55        2</span></span>
<span><span class="co">#&gt; 160    766.97171   -298.100948  -329.8522668  55        3</span></span>
<span><span class="co">#&gt; 161   1142.38540   -326.524286  -304.3146347  55        4</span></span>
<span><span class="co">#&gt; 162   1656.73773   -609.393285   -80.8394169  55        5</span></span>
<span><span class="co">#&gt; 163  -1629.93078   -796.082936   486.8332032  56        1</span></span>
<span><span class="co">#&gt; 164  -4857.06301    292.090728   -44.8730406  56        2</span></span>
<span><span class="co">#&gt; 165 -11732.47043   2676.251056 -2060.4364082  56        3</span></span>
<span><span class="co">#&gt; 166    905.21026     75.842727  -760.3789879  56        4</span></span>
<span><span class="co">#&gt; 167  -4345.49213   -367.444012  -392.5282262  56        5</span></span>
<span><span class="co">#&gt; 168  10209.35059  -1559.653395  2058.3481568  57        1</span></span>
<span><span class="co">#&gt; 169  -1198.76836   1725.999267   322.1090127  57        2</span></span>
<span><span class="co">#&gt; 170   3552.04010    975.296633   717.7147525  57        3</span></span>
<span><span class="co">#&gt; 171  -1524.14026   1752.352462   250.4981248  57        4</span></span>
<span><span class="co">#&gt; 172   5427.79635    961.917156   375.6478085  57        5</span></span>
<span><span class="co">#&gt; 173  -4504.32971    900.205314  -513.3438506  60        1</span></span>
<span><span class="co">#&gt; 174    756.85747    324.007541  -353.1330182  60        2</span></span>
<span><span class="co">#&gt; 175  -6585.79278  -1768.883410   123.0381790  60        3</span></span>
<span><span class="co">#&gt; 176   -948.46011    583.238786  -212.3727417  60        4</span></span>
<span><span class="co">#&gt; 177 -10955.06961    544.648840   310.0853752  60        5</span></span>
<span><span class="co">#&gt; 178   2255.13496    480.613921  -173.2451256  63        1</span></span>
<span><span class="co">#&gt; 179   2028.61682   -244.605383   293.8002222  63        2</span></span>
<span><span class="co">#&gt; 180   3170.84465    388.473827  -289.5649383  63        3</span></span>
<span><span class="co">#&gt; 181 -15046.10435 -11454.795663  2440.8612345  63        4</span></span>
<span><span class="co">#&gt; 182     84.12852    361.587248  -268.2305743  63        5</span></span>
<span><span class="co">#&gt; 183    411.04707   -944.859697  -319.2141741  66        1</span></span>
<span><span class="co">#&gt; 184  -5980.14882    385.152424  -109.6082300  66        2</span></span>
<span><span class="co">#&gt; 185  -1947.39148   -375.105011  -521.3347127  66        3</span></span>
<span><span class="co">#&gt; 186   1246.05402    509.205639  -796.5838977  66        4</span></span>
<span><span class="co">#&gt; 187  -2660.44433   -330.866888  -752.1611493  66        5</span></span>
<span><span class="co">#&gt; 188  -5753.15746    802.817321  -388.7939881  67        1</span></span>
<span><span class="co">#&gt; 189   1297.53452   -248.435334  -257.5504521  67        2</span></span>
<span><span class="co">#&gt; 190   1077.96326    -22.950512   -96.3094661  67        3</span></span>
<span><span class="co">#&gt; 191  -1581.42112   -388.714945   -90.4533247  67        4</span></span>
<span><span class="co">#&gt; 192   2094.50206   -131.449879  -215.6516353  67        5</span></span>
<span><span class="co">#&gt; 193   2363.19584    313.802401  -116.4800497  68        1</span></span>
<span><span class="co">#&gt; 194   2637.71134    111.428573    17.4908064  68        2</span></span>
<span><span class="co">#&gt; 195  -2314.71461    892.347896  -179.7680820  68        3</span></span>
<span><span class="co">#&gt; 196   2839.90032   -553.787787    19.3153713  68        4</span></span>
<span><span class="co">#&gt; 197   2918.89445   -300.558625  -428.0698651  68        5</span></span>
<span><span class="co">#&gt; 198   1340.29157   2249.772338   529.2835306  70        1</span></span>
<span><span class="co">#&gt; 199   2104.21836   -169.540054   922.9011918  70        2</span></span>
<span><span class="co">#&gt; 200   6427.11230   2516.034756  -956.7839530  70        3</span></span>
<span><span class="co">#&gt; 201  -4249.44005  -1248.492151  1439.2019951  70        4</span></span>
<span><span class="co">#&gt; 202   6458.15936    457.670130   446.1654947  70        5</span></span>
<span><span class="co">#&gt; 203  -3714.19368    229.918447  -469.4547995  75        1</span></span>
<span><span class="co">#&gt; 204   2262.13269   -456.173223  -337.4982755  75        2</span></span>
<span><span class="co">#&gt; 205  -1522.34824   -580.414014  -313.6129314  75        3</span></span>
<span><span class="co">#&gt; 206   1047.62647    -22.363736  -196.2828954  75        4</span></span>
<span><span class="co">#&gt; 207  -5070.15062   -121.151305   -78.1988129  76        1</span></span>
<span><span class="co">#&gt; 208  -2481.67082  -3010.151923   575.9594324  76        2</span></span>
<span><span class="co">#&gt; 209   3156.11465    667.901655  -198.9869708  76        3</span></span>
<span><span class="co">#&gt; 210   2162.09732    862.937557  -355.7129075  76        4</span></span>
<span><span class="co">#&gt; 211  -2582.66377    209.425862    88.5928330  76        5</span></span>
<span><span class="co">#&gt; 212    992.11209   -296.144311  -321.8814525  77        1</span></span>
<span><span class="co">#&gt; 213  -2776.59329   -407.124065  -385.3223915  77        2</span></span>
<span><span class="co">#&gt; 214  -3428.09197    318.797834  -326.6352575  77        3</span></span>
<span><span class="co">#&gt; 215   1640.61344   -385.471479  -328.1463078  77        4</span></span>
<span><span class="co">#&gt; 216    966.35924   -235.712059  -448.8042638  77        5</span></span>
<span><span class="co">#&gt; 217    -12.23406     19.388237  -306.9246912  78        1</span></span>
<span><span class="co">#&gt; 218   3197.70831    221.506765  -139.3197521  78        2</span></span>
<span><span class="co">#&gt; 219   3615.01552   -616.616280    67.2144771  78        3</span></span>
<span><span class="co">#&gt; 220   3457.42559   -477.045668  -170.8254512  78        4</span></span>
<span><span class="co">#&gt; 221   3255.54103    257.814881  -172.1801963  78        5</span></span>
<span><span class="co">#&gt; 222  11241.47347   2464.593503   622.9585162   8        1</span></span>
<span><span class="co">#&gt; 223   4298.02445   2765.559760   563.5953811   8        2</span></span>
<span><span class="co">#&gt; 224  -2507.39426   1136.088227   920.3961020   8        3</span></span>
<span><span class="co">#&gt; 225  11298.37462    828.454809  1509.3331881   8        4</span></span>
<span><span class="co">#&gt; 226  15214.52558   1409.899364   559.1432020   8        5</span></span>
<span><span class="co">#&gt; 227   -989.35054  -1732.560681   611.4767972  87        1</span></span>
<span><span class="co">#&gt; 228   1494.85001   1384.603849   473.7783393  87        2</span></span>
<span><span class="co">#&gt; 229   7583.71683   1062.012963  -221.3578137  87        3</span></span>
<span><span class="co">#&gt; 230 -20846.81141   2001.986926  5176.7698066  87        4</span></span>
<span><span class="co">#&gt; 231  -4188.67526     26.988546  -580.4671107  87        5</span></span>
<span><span class="co">#&gt; 232   2281.75518    424.889360  -213.7033576   9        1</span></span>
<span><span class="co">#&gt; 233   -832.16860    320.972250    17.0982838   9        2</span></span>
<span><span class="co">#&gt; 234    484.45793    228.418574   -46.2885271   9        3</span></span>
<span><span class="co">#&gt; 235    395.54738    594.811634  -154.5900432   9        4</span></span>
<span><span class="co">#&gt; 236    391.47798    418.627647  -101.1592408   9        5</span></span>
<span><span class="co">#&gt; 237   1495.03235    289.089427   196.4474425  90        1</span></span>
<span><span class="co">#&gt; 238   -800.11955   1038.953899  -465.6588601  90        2</span></span>
<span><span class="co">#&gt; 239  -2258.15300    320.731750   364.0854302  90        3</span></span>
<span><span class="co">#&gt; 240   2862.96865    522.846866    64.4035468  90        4</span></span>
<span><span class="co">#&gt; 241    617.46993    842.411202   -29.1903615  90        5</span></span>
<span><span class="co">#&gt; 242   1844.38912    197.365542  -269.1720143  93        1</span></span>
<span><span class="co">#&gt; 243   1914.96413   -997.456867   887.7965007  93        2</span></span>
<span><span class="co">#&gt; 244   3454.70503  -2368.934139  -895.6946813  93        3</span></span>
<span><span class="co">#&gt; 245   1008.89739   -344.602167   196.7602050  93        4</span></span>
<span><span class="co">#&gt; 246  -7741.52058    997.903314  -279.3875537  93        5</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_mfpc.html">plot_mfpc</a></span><span class="op">(</span><span class="va">mfpca_obj</span><span class="op">$</span><span class="va">mfpc_object</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="a02_mx_fpca_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#library(refund.shiny)</span></span>
<span><span class="co">#plot_shiny(mfpca)</span></span></code></pre></div>
<p>Calculate variance of level 2 scores. Also, are the</p>
<p>ICC</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="fda-tips-principles-things-to-know">FDA Tips / Principles/ Things to know<a class="anchor" aria-label="anchor" href="#fda-tips-principles-things-to-know"></a>
</h2>
<ul>
<li>Sparse vs. even grids- mention these, and what types of analysis you
can do with each</li>
<li>Better to have 20+ measurements per curve- that means using a dense
grid of radii</li>
<li>Number of knots cannot exceed the number of datapoints per
function</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julia Wrobel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
