<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mxfda">
<title>Functional regression with spatial summary functions as covariates • mxfda</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functional regression with spatial summary functions as covariates">
<meta property="og:description" content="mxfda">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mxfda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mx_fda.html">Defining an mxFDA object</a>
    <a class="dropdown-item" href="../articles/mx_fpca.html">Functional principal component analysis for spatial summary functions</a>
    <a class="dropdown-item" href="../articles/mx_funreg.html">Functional regression with spatial summary functions as covariates</a>
    <a class="dropdown-item" href="../articles/web_only/st_fpca.html">Functional Regression with Spatial Transcriptomics Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/julia-wrobel/mxfda/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Functional regression with spatial summary functions as covariates</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/julia-wrobel/mxfda/blob/HEAD/vignettes/mx_funreg.Rmd" class="external-link"><code>vignettes/mx_funreg.Rmd</code></a></small>
      <div class="d-none name"><code>mx_funreg.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://github.com/julia-wrobel/mxfda/" class="external-link">mxfda</a> package contains tools for analyzing spatial
single-cell data, including multiplex imaging and spatial
transcriptomics, using methods from functional data analysis. Analyses
for this package are executed and stored using an S4 object of class
<code>mxFDA</code>. This vignette outlines how to perform functional
regression using spatial summary functions of multiplex image samples as
model covariates. To set up an <code>mxFDA</code> object from spatial
single cell data, calculate spatial summary functions, and perform
exploratory data analysis and visualization of these spatial summary
functions, see <code><a href="../articles/mx_fda.html">vignette("mx_fda")</a></code>. To perform feature
extraction using functional principal component analysis, see
<code><a href="../articles/mx_fpca.html">vignette("mx_fpca")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/julia-wrobel/mxfda/" class="external-link">mxfda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="ovarian-cancer-multiplex-imaging-data">Ovarian cancer multiplex imaging data<a class="anchor" aria-label="anchor" href="#ovarian-cancer-multiplex-imaging-data"></a>
</h2>
<p>Here we load data from the Ovarian cancer dataset where univariate
nearest-neighbor G-functions for immune cells have already been
estimated. See the vignette <code>mxfda::mx_fda</code> for more details
on extracting spatial summary functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ovarian_FDA"</span><span class="op">)</span></span></code></pre></div>
<p>We visualize these functions below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, y <span class="op">=</span> <span class="st">"fundiff"</span>, what <span class="op">=</span> <span class="st">"uni g"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Nearest neighbor G-functions for immune cells"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="functional-regression-models-for-survival-outcomes">Functional regression models for survival outcomes<a class="anchor" aria-label="anchor" href="#functional-regression-models-for-survival-outcomes"></a>
</h2>
<p>Single-cell imaging is common in cancer applications, where the
analysis goal is to relate cell-level spatial information to
patient-level time-to-event outcomes like overall survival or
time-to-recurrence. Cox regression is a popular regression technique for
assessing the association between covariates and a survival outcome. The
standard Cox model is given by</p>
<p><span class="math display">\[\log h_i(t) = \log h_0(t) + \sum_{p =
1}^P \gamma_p Z_{ip},\]</span></p>
<p>where <span class="math inline">\(h_i(t)\)</span> is the <em>hazard
rate</em> for subject <span class="math inline">\(i\)</span> and <span class="math inline">\(h_0(t)\)</span> is an unspecified baseline hazard.
Each <span class="math inline">\(Z_{ip}\)</span> is a scalar covariate,
and <span class="math inline">\(P\)</span> is the total number of scalar
covariates. These are covariates like age, sex, treatment group, etc and
can be contrasted with spatial summary functions which are known as
functional covariates. The <span class="math inline">\(\gamma_p\)</span>
are regression coefficients; these are interpreted as log hazard
ratios.</p>
<p>For single cell spatial data, we have a spatial summary function for
each subject (e.g. univariate Ripley’s K), <span class="math inline">\(X_i(r)\)</span>, that we want to add to the Cox
regression model as a functional covariate. Below we provide three
different strategies for incorporating <span class="math inline">\(X_i(r)\)</span> into a Cox regression model as a
covariate.</p>
<div class="section level3">
<h3 id="cox-regression-using-functional-principal-components-as-covariates">Cox regression using functional principal components as
covariates<a class="anchor" aria-label="anchor" href="#cox-regression-using-functional-principal-components-as-covariates"></a>
</h3>
<p>In this approach, we first decompose the spatial summary functions
using FPCA, then use subject-specific scores from FPCA as covariates in
a Cox regression model. Conceptually, we are fitting the model given
by</p>
<p><span class="math display">\[\log h_i(t) = \log h_0(t) + \sum_{p =
1}^P \gamma_p Z_{ip} + \sum_{k = 1}^K \beta_k c_{ik},\]</span></p>
<p>where <span class="math inline">\(c_{ik}\)</span> is the <span class="math inline">\(k\)</span>th score from functional principal
components analysis for the <span class="math inline">\(i\)</span>th
subject. <span class="math inline">\(K\)</span> represents the number of
principal components, usually selected to explain at least 95% of the
variance in the spatial summary functions (see
<code><a href="../articles/mx_fpca.html">vignette("mx_fpca")</a></code>). The <span class="math inline">\(\beta_k\)</span> are regression coefficients that
tell us about the association between overall survival and the <span class="math inline">\(k\)</span>th functional principal component. Like
the <span class="math inline">\(\gamma_p\)</span>, the the <span class="math inline">\(\beta_k\)</span> are interpreted as log hazard
ratios, and <span class="math inline">\(e^{\beta_k}\)</span> is a hazard
ratio. This is the approach to Cox regression with spatial summary
functions as covariates taken in <span class="citation">Vu et al.
(2023)</span>.</p>
<p>The code below runs FPCA the G-functions from the ovarian cancer data
and calculates principal components that explain up to 99% variance
using the argument <code>pve</code>. The argument
<code>lightweight = TRUE</code> returns only what is needed for
downstream analysis. To return all items calculate by FPCA when using
<code><a href="https://rdrr.io/pkg/refund/man/fpca.face.html" class="external-link">refund::fpca.face</a></code>, use
<code>lightweight = FALSE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_fpca.html">run_fpca</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span>,</span>
<span>                        lightweight <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        pve <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span></span>
<span><span class="va">ovarian_FDA</span></span>
<span><span class="co">#&gt; mxFDA Object:</span></span>
<span><span class="co">#&gt;  Subjects: 128</span></span>
<span><span class="co">#&gt;  Samples: 128</span></span>
<span><span class="co">#&gt;  Has spatial data</span></span>
<span><span class="co">#&gt;  Univariate Summaries: Gest</span></span>
<span><span class="co">#&gt;  Bivariate Summaries: None</span></span>
<span><span class="co">#&gt; FPCs Calculated:</span></span>
<span><span class="co">#&gt;  Gest: 6 FPCs describe 99.2% variance</span></span>
<span><span class="co">#&gt; MFPCs not yet calculated</span></span>
<span><span class="co">#&gt; FCMs not yet calculated</span></span>
<span><span class="co">#&gt; MFCMs not yet calculated</span></span>
<span><span class="co">#&gt; Scalar on Functional Regression not calculated</span></span></code></pre></div>
<p>Six FPCs were returned. Below, we extract the fpca scores from the
<code>ovarian_FDA</code> object and visualize the relationship between
the first two FPC scores and survival time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gdf_fpc</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_fpca_scores.html">extract_fpca_scores</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g fpca'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="va">Gdf_fpc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">event</span>, levels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"censored"</span>, <span class="st">"died"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">fpc1</span>, <span class="va">survival_time</span>, color <span class="op">=</span> <span class="va">event</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"survival time (days)"</span>, title <span class="op">=</span> <span class="st">"fpc1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="va">Gdf_fpc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">event</span>, levels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"censored"</span>, <span class="st">"died"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">fpc2</span>, <span class="va">survival_time</span>, color <span class="op">=</span> <span class="va">event</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"survival time (days)"</span>, title <span class="op">=</span> <span class="st">"fpc2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>It appears that subjects with lower scores for FPC 1 tended to have
longer survival times.</p>
<p>Next, we use these scores as covariates in a Cox regression model. We
also control for age.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="va">phmod_fpc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">survival_time</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">fpc1</span> <span class="op">+</span> <span class="va">fpc2</span> <span class="op">+</span> <span class="va">fpc3</span> <span class="op">+</span> <span class="va">fpc4</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>              data <span class="op">=</span> <span class="va">Gdf_fpc</span><span class="op">)</span></span></code></pre></div>
<p>The results from this model are printed below in a tidy format. Note
that all FPCs except FPC 2 have a statistically significant relationship
with overall survival. The hazard ratio above 1 for FPC 1 indicates that
higher scores are associate with worse survival outcomes, which is
consistent with the exploratory analysis in the plot above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">phmod_fpc</span>, exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html" class="external-link">format.pval</a></span><span class="op">(</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">term</span>, hazard_ratio <span class="op">=</span> <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, p <span class="op">=</span> <span class="va">p.value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">hazard_ratio</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">fpc1</td>
<td align="right">4.38</td>
<td align="right">2.58</td>
<td align="right">7.46</td>
<td align="left">5e-08</td>
</tr>
<tr class="even">
<td align="left">fpc2</td>
<td align="right">1.16</td>
<td align="right">0.46</td>
<td align="right">2.89</td>
<td align="left">0.754</td>
</tr>
<tr class="odd">
<td align="left">fpc3</td>
<td align="right">62.67</td>
<td align="right">7.24</td>
<td align="right">542.16</td>
<td align="left">2e-04</td>
</tr>
<tr class="even">
<td align="left">fpc4</td>
<td align="right">0.04</td>
<td align="right">0.00</td>
<td align="right">0.67</td>
<td align="left">0.026</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">1.03</td>
<td align="right">1.01</td>
<td align="right">1.05</td>
<td align="left">0.009</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="linear-and-additive-functional-cox-regression-models">Linear and additive functional Cox regression models<a class="anchor" aria-label="anchor" href="#linear-and-additive-functional-cox-regression-models"></a>
</h3>
<p>Linear and additive functional Cox regression models were used in
<span class="citation">Vu et al. (2022)</span> to model the relationship
between survival and spatial summary functions without having to first
decompose the spatial summary functions using FPCA. Linear functional
cox regression was first introduced by <span class="citation">Gellar et
al. (2015)</span> and takes the form:</p>
<p><span class="math display">\[\log h_i(t;Z_i, X_i) = \log h_0(t) +
\sum_{p = 1}^P \gamma_p Z_{ip} + \int_{r = 0}^R
\beta(r)X_i(r)dr,\]</span></p>
<p>where <span class="math inline">\(X_i(r)\)</span> is the spatial
summary function for subject <span class="math inline">\(i\)</span>, and
<span class="math inline">\(\beta(r)\)</span> is a <em>coefficient
function</em>. For this model, the coefficient function is a log hazard
ratio for the spatial summary function at radius <span class="math inline">\(r\)</span>. In effect, this allows us to model the
association between of spatial clustering and survival at many different
radii simultaneously. Here <span class="math inline">\(X_i(r)\)</span>
is considered a <em>functional covariate</em>, and the <span class="math inline">\(Z_{ip}\)</span> are <em>scalar
covariates</em>.</p>
<div class="section level4">
<h4 id="linear-functional-cox-model-lfcm">Linear functional Cox model (LFCM)<a class="anchor" aria-label="anchor" href="#linear-functional-cox-model-lfcm"></a>
</h4>
<p>The code below runs an LFCM for the G-functions from the ovarian
cancer data with age as a scalar covariate. Setting the argument
<code>afcm = FALSE</code> runs an LFCM instead of an AFCM.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">=</span> <span class="fu"><a href="../reference/run_fcm.html">run_fcm</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, model_name <span class="op">=</span> <span class="st">"fit_lfcm"</span>,</span>
<span>                      formula <span class="op">=</span> <span class="va">survival_time</span> <span class="op">~</span> <span class="va">age</span>, event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>                      metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span>,</span>
<span>                      afcm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Below we print the class and summary of the extracted model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_lfcm'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "lfcm" "gam"  "glm"  "lm"</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_lfcm'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: Cox PH </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; survival_time ~ age + s(t_int, by = l_int * func, bs = "cr", </span></span>
<span><span class="co">#&gt;     k = 20)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;     Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">#&gt; age  0.03083    0.01136   2.714  0.00664 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                         edf Ref.df Chi.sq  p-value    </span></span>
<span><span class="co">#&gt; s(t_int):l_int * func 4.286  4.759  41.02 4.76e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance explained = 5.72%</span></span>
<span><span class="co">#&gt; -REML = 314.14  Scale est. = 1         n = 128</span></span></code></pre></div>
<p>Finally, we visualized the estimated coefficient function, <span class="math inline">\(\hat{\beta}(r)\)</span>, from this model. The code
below extracts this quantity, then plots <span class="math inline">\(\hat{\beta}(r)\)</span> as a solid black line and
95% pointwise confidence intervals as dotted black lines. Values of the
radius <span class="math inline">\(r\)</span> where the 95% confidence
interval does not contain zero are statistically significant.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfcm_surface</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_surface.html">extract_surface</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, metric <span class="op">=</span> <span class="st">"uni g"</span>, model <span class="op">=</span> <span class="st">"fit_lfcm"</span>, analysis_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lfcm_surface</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="additive-functional-cox-model-afcm">Additive functional Cox model (AFCM)<a class="anchor" aria-label="anchor" href="#additive-functional-cox-model-afcm"></a>
</h4>
<p>Additive functional cox regression was first introduced by <span class="citation">Cui, Crainiceanu, and Leroux (2021)</span> and takes
the form:</p>
<p><span class="math display">\[\log h_i(t;Z_i, X_i) = \log h_0(t) +
\sum_{p = 1}^P \gamma_p Z_{ip} + \int_{r = 0}^R F\left(r,
X_i(r)\right)dr.\]</span></p>
<p>This model is slightly more flexible than the LFCM, in that it allows
the relationship between <span class="math inline">\(X_i(r)\)</span> and
survival to vary nonlinearly with <span class="math inline">\(r\)</span>.</p>
<p>The code below runs an AFCM with age as a scalar covariate. Setting
the argument <code>afcm = TRUE</code> runs an AFCM.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_fcm.html">run_fcm</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, model_name <span class="op">=</span> <span class="st">"fit_afcm"</span>, </span>
<span>                       formula <span class="op">=</span> <span class="va">survival_time</span> <span class="op">~</span> <span class="va">age</span>, event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>                       metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span>,</span>
<span>                       afcm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_afcm'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "afcm" "gam"  "glm"  "lm"</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_afcm'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: Cox PH </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; survival_time ~ age + ti(t_int, func, by = l_int, bs = c("cr", </span></span>
<span><span class="co">#&gt;     "cr"), k = c(10, 10), mc = c(FALSE, TRUE))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;     Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; age  0.02852    0.01162   2.454   0.0141 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                        edf Ref.df Chi.sq p-value    </span></span>
<span><span class="co">#&gt; ti(t_int,func):l_int 8.248  10.52  55.88  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance explained = 10.7%</span></span>
<span><span class="co">#&gt; -REML = 310.05  Scale est. = 1         n = 128</span></span></code></pre></div>
<p>The AFCM model produces a <em>coefficient surface</em>, <span class="math inline">\(\hat{F}\left(r, X_i(r)\right)\)</span>, rather
than a coefficient function. The code below extracts this estimated
surface, then on the left plots the surface, and on the right plots
regions of the surface that are statistically significant at the 95%
confidence level.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">afcm_surface</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_surface.html">extract_surface</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, metric <span class="op">=</span> <span class="st">"uni g"</span>, model <span class="op">=</span> <span class="st">"fit_afcm"</span>, analysis_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">afcm_surface</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/extract_estimates-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="model-summaries-and-c-index">Model summaries and C-index<a class="anchor" aria-label="anchor" href="#model-summaries-and-c-index"></a>
</h3>
<p>C-index is a good way to compare across models, especially when
incorporating cross validation. Larger c-index is indicative of a better
predictive model. Below, we calculate the c-index for each model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_afcm</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_afcm'</span><span class="op">)</span></span>
<span><span class="va">fit_lfcm</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, <span class="st">'cox'</span>, <span class="st">'fit_lfcm'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">phmod_fpc</span><span class="op">$</span><span class="va">concordance</span><span class="op">[[</span><span class="st">"concordance"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>  <span class="fu"><a href="../reference/extract_c.html">extract_c</a></span><span class="op">(</span><span class="va">fit_lfcm</span>, <span class="va">Gdf_fpc</span><span class="op">$</span><span class="va">survival_time</span>, <span class="va">Gdf_fpc</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/extract_c.html">extract_c</a></span><span class="op">(</span><span class="va">fit_afcm</span>, <span class="va">Gdf_fpc</span><span class="op">$</span><span class="va">survival_time</span>, <span class="va">Gdf_fpc</span><span class="op">$</span><span class="va">event</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fpc"</span>, <span class="st">"lfcm"</span>, <span class="st">"afcm"</span><span class="op">)</span>, <span class="va">c_index</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">model</th>
<th align="right">c_index</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">fpc</td>
<td align="right">0.71</td>
</tr>
<tr class="even">
<td align="left">lfcm</td>
<td align="right">0.73</td>
</tr>
<tr class="odd">
<td align="left">afcm</td>
<td align="right">0.76</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="functional-regression-models-for-binary-and-continuous-outcomes">Functional regression models for binary and continuous outcomes<a class="anchor" aria-label="anchor" href="#functional-regression-models-for-binary-and-continuous-outcomes"></a>
</h2>
<p>Models with continuous or binary scalar outcomes and functional
covariates are also possible, and are referred to as
<em>scalar-on-function regression</em> (sofr) models in the functional
data analysis literature (<span class="citation">Goldsmith et al.
(2011)</span>).</p>
<div class="section level3">
<h3 id="continuous-outcome">Continuous outcome<a class="anchor" aria-label="anchor" href="#continuous-outcome"></a>
</h3>
<p>Below we fit a sofr model with age as the outcome, G-functions from
the ovarian cancer data as the functional covariate, and no additional
scalar covariates using the <code><a href="../reference/run_sofr.html">run_sofr()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sofr.html">run_sofr</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, </span>
<span>                        model_name <span class="op">=</span> <span class="st">"fit_sofr_age"</span>, </span>
<span>                        formula <span class="op">=</span> <span class="va">age</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>                        metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span><span class="op">)</span></span></code></pre></div>
<p>This model also produces an estimated coefficient surface <span class="math inline">\(\hat{\beta}(r)\)</span>, which can be visualized.
The code below extracts this quantity, then plots <span class="math inline">\(\hat{\beta}(r)\)</span> as a solid black line and
95% pointwise confidence intervals as dotted black lines. Values of the
radius <span class="math inline">\(r\)</span> where the 95% confidence
interval does not contain zero are statistically significant. At each
radius value <span class="math inline">\(r\)</span>, for a continuous
outcome <span class="math inline">\(\hat{\beta}(r)\)</span> can be
interpreted as a regular linear regression coefficient.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, type <span class="op">=</span> <span class="st">'sofr'</span>, model_name <span class="op">=</span> <span class="st">'fit_sofr_age'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"t"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="binary-outcome">Binary outcome<a class="anchor" aria-label="anchor" href="#binary-outcome"></a>
</h3>
<p>Below we fit a sofr model with stage as the outcome, G-functions from
the ovarian cancer data as the functional covariate, and age as a scalar
covariate. Stage is a binary outcome, and as a result this model can
also be called <em>functional logistic regression</em>. When the outcome
is binary, you need to specify the argument
<code>family = "binomial"</code>. In addition, the outcome should be
coded as a numeric rather than a factor or character variable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ovarian_FDA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sofr.html">run_sofr</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, </span>
<span>                        model_name <span class="op">=</span> <span class="st">"fit_sofr_stage"</span>, </span>
<span>                        formula <span class="op">=</span> <span class="va">stage</span> <span class="op">~</span> <span class="va">age</span>, </span>
<span>                        family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>                        metric <span class="op">=</span> <span class="st">"uni g"</span>, r <span class="op">=</span> <span class="st">"r"</span>, value <span class="op">=</span> <span class="st">"fundiff"</span><span class="op">)</span></span></code></pre></div>
<p>When the outcome is binary <span class="math inline">\(\hat{\beta}(r)\)</span> is interpreted as a log
odds ratio at each radius <span class="math inline">\(r\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract_model.html">extract_model</a></span><span class="op">(</span><span class="va">ovarian_FDA</span>, <span class="st">'uni g'</span>, type <span class="op">=</span> <span class="st">'sofr'</span>, model_name <span class="op">=</span> <span class="st">'fit_sofr_stage'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"t"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mx_funreg_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-cui2021additive" class="csl-entry">
Cui, Erjia, Ciprian M Crainiceanu, and Andrew Leroux. 2021.
<span>“Additive Functional Cox Model.”</span> <em>Journal of
Computational and Graphical Statistics</em> 30 (3): 780–93.
</div>
<div id="ref-gellar2015cox" class="csl-entry">
Gellar, Jonathan E, Elizabeth Colantuoni, Dale M Needham, and Ciprian M
Crainiceanu. 2015. <span>“Cox Regression Models with Functional
Covariates for Survival Data.”</span> <em>Statistical Modelling</em> 15
(3): 256–78.
</div>
<div id="ref-goldsmith2011penalized" class="csl-entry">
Goldsmith, Jeff, Jennifer Bobb, Ciprian M Crainiceanu, Brian Caffo, and
Daniel Reich. 2011. <span>“Penalized Functional Regression.”</span>
<em>Journal of Computational and Graphical Statistics</em> 20 (4):
830–51.
</div>
<div id="ref-vu2023funspace" class="csl-entry">
Vu, Thao, Souvik Seal, Tusharkanti Ghosh, Mansooreh Ahmadian, Julia
Wrobel, and Debashis Ghosh. 2023. <span>“FunSpace: A Functional and
Spatial Analytic Approach to Cell Imaging Data Using Entropy
Measures.”</span> <em>PLOS Computational Biology</em> 19 (9): e1011490.
</div>
<div id="ref-vu2022spf" class="csl-entry">
Vu, Thao, Julia Wrobel, Benjamin G Bitler, Erin L Schenk, Kimberly R
Jordan, and Debashis Ghosh. 2022. <span>“SPF: A Spatial and Functional
Data Analytic Approach to Cell Imaging Data.”</span> <em>PLoS
Computational Biology</em> 18 (6): e1009486.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Julia Wrobel, Alex Soupir.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
