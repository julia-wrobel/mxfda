<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>extract_summary_functions — extract_summary_functions • mxfda</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="extract_summary_functions — extract_summary_functions"><meta property="og:description" content="This is the main function for the fastGFPCA package.
The function requires input data Y to be a dataframe in long format with variables
id, index, and value to indicate subject IDs,
observation times on the domain, and observations, respectively.
The index must contain the same, equally spaced grid points for each subject.
The number of functional principal components (FPCs) can either be specified
directly (argument npc) or chosen based on the explained share of
variance (pve). Families and link functions can be specified using the same
syntax as the family argument from the lme4::glmer() function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mxfda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a01_mx_fda.html">mxFDA Object</a>
    </li>
    <li>
      <a href="../articles/a02_mx_fpca.html">Multiplex FPCA</a>
    </li>
    <li>
      <a href="../articles/a03_mx_funreg.html">mx Functional Regression</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/julia-wrobel/mxfda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>extract_summary_functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/julia-wrobel/mxfda/blob/HEAD/R/extract_summary_functions.R" class="external-link"><code>R/extract_summary_functions.R</code></a></small>
    <div class="hidden name"><code>extract_summary_functions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function for the fastGFPCA package.
The function requires input data <code>Y</code> to be a dataframe in long format with variables
<code>id</code>, <code>index</code>, and <code>value</code> to indicate subject IDs,
observation times on the domain, and observations, respectively.
The <code>index</code> must contain the same, equally spaced grid points for each subject.
The number of functional principal components (FPCs) can either be specified
directly (argument <code>npc</code>) or chosen based on the explained share of
variance (<code>pve</code>). Families and link functions can be specified using the same
syntax as the <code>family</code> argument from the <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_summary_functions</span><span class="op">(</span></span>
<span>  <span class="va">mxFDAobject</span>,</span>
<span>  r_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  extract_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">extract_univariate</span>, <span class="va">extract_bivariate</span><span class="op">)</span>,</span>
<span>  summary_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Kest</span>, <span class="va">Lest</span>, <span class="va">Gest</span><span class="op">)</span>,</span>
<span>  <span class="va">markvar</span>,</span>
<span>  <span class="va">mark1</span>,</span>
<span>  mark2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">edge_correction</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>r_vec</dt>
<dd><p>Numeric vector of radii over which to evaluate spatial summary functions. Must begin at 0.</p></dd>


<dt>extract_func</dt>
<dd><p>Defaults to extract_univariate, which calculates univariate spatial summary functions. Choose extract_bivariate for bivariate spatial summary functions.</p></dd>


<dt>summary_func</dt>
<dd><p>Spatial summary function to calculate. Options are c(Kest, Lest, Gest) which denote Ripley's K, Besag's L, and nearest neighbor G function, respectively.</p></dd>


<dt>markvar</dt>
<dd><p>The name of the variable that denotes cell type(s) of interest. Character.</p></dd>


<dt>mark1</dt>
<dd><p>Character string that denotes first cell type of interest.</p></dd>


<dt>mark2</dt>
<dd><p>Character string that denotes second cell type of interest for calculating bivariate summary statistics. Not used when calculating univariate statistics.</p></dd>


<dt>edge_correction</dt>
<dd><p>Character string that denotes the edge correction method for spatial summary function. For Kest and Lest choose one of c("border", "isotropic", "Ripley", "translate", "none"). For Gest choose one of c("rs", "km", "han")</p></dd>


<dt>mxdata</dt>
<dd><p>Dataframe of cell-level multiplex imaging data. Should have variables x and y to denote x and y spatial locations of each cell.</p></dd>


<dt>analysis_vars</dt>
<dd><p>Optional list of variables to be retained for downstream analysis.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.frame</code> containing:</p>
<dl><dt>image_patient_id</dt>
<dd><p>the unique image id</p></dd>

<dt>r</dt>
<dd><p>the radius of values over which the spatial summary function is evaluated</p></dd>

<dt>sumfun</dt>
<dd><p>the values of the spatial summary function</p></dd>

<dt>csr</dt>
<dd><p>the values of the spatial summary function under complete spatial randomness</p></dd>

<dt>fundiff</dt>
<dd><p>sumfun - csr, positive values indicate clustering and negative values repulsion</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Xiao, L., Ruppert, D., Zipunnikov, V., and Crainiceanu, C. (2016).
Fast covariance estimation for high-dimensional functional data.
<em>Statistics and Computing</em>, 26, 409-421.
DOI: 10.1007/s11222-014-9485-x.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Julia Wrobel <a href="mailto:julia.wrobel@cuanschutz.edu">julia.wrobel@cuanschutz.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1001</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Julia Wrobel, Alex Soupir.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

